<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TON Payment Wallet Connect</title>
  </head>
  <body>
    <h2>Connect EVM Wallet</h2>
    <button id="connectWallet">Connect Wallet</button>
    <p id="walletAddress"></p>

    <!-- ‚úÖ Load Reown SDK FIRST -->
    <script src="https://reown.com/sdk/reown.js"></script>

    <script>
      const PROJECT_ID = "7be08574a6238618945452abdd8b896a";

      async function initWallet() {
        console.log("Initializing Reown‚Ä¶");

        if (typeof window.Reown === "undefined") {
          alert("‚ùå Reown SDK failed to load. Check script URL.");
          return;
        }

        // ‚úÖ Proper initialization
        const reown = new window.Reown({
          projectId: PROJECT_ID,
          chains: [1, 137, 56], // Ethereum, Polygon, BSC
        });

        window.reown = reown;
        console.log("‚úÖ Reown initialized", reown);
      }

      async function connectWallet() {
        try {
          if (!window.reown) {
            await initWallet();
          }

          console.log("üöÄ Connecting wallet...");
          const provider = await window.reown.connect();

          if (!provider) throw new Error("No provider returned");

          const accounts = await provider.request({ method: "eth_requestAccounts" });
          document.getElementById("walletAddress").innerText = `Connected: ${accounts[0]}`;
        } catch (err) {
          console.error("Wallet connection failed:", err);
          alert("Wallet connection failed ‚Äî check console logs for detailed errors.");
        }
      }

      document.getElementById("connectWallet").addEventListener("click", connectWallet);
    </script>
  </body>
</html>
